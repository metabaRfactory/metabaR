<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Aggregate MOTUs — aggregate_motus • metabaR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregate MOTUs — aggregate_motus"><meta property="og:description" content="Aggregate MOTUs in a metabarlist object according to a grouping factor or vector"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metabaR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/metabaRF-vignette_karst.html">The karst_euk dataset: sampler effect and technical reproducibility</a>
    </li>
    <li>
      <a href="../articles/metabaRF-vignette.html">Let's metabaR!</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/metabaRfactory/metabaR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Aggregate MOTUs</h1>
    <small class="dont-index">Source: <a href="https://github.com/metabaRfactory/metabaR/blob/master/R/aggregate_motus.R" class="external-link"><code>R/aggregate_motus.R</code></a></small>
    <div class="hidden name"><code>aggregate_motus.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Aggregate MOTUs in a <code>metabarlist</code> object according to a grouping factor or vector</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">aggregate_motus</span><span class="op">(</span><span class="va">metabarlist</span>, groups <span class="op">=</span> <span class="cn">NULL</span>, FUN <span class="op">=</span> <span class="va">FUN_agg_motus_sum</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">FUN_agg_motus_sum</span><span class="op">(</span><span class="va">metabarlist</span>, <span class="va">groups</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-metabarlist">metabarlist<a class="anchor" aria-label="anchor" href="#arg-metabarlist"></a></dt>
<dd><p>a <code>metabarlist</code> object</p></dd>


<dt id="arg-groups">groups<a class="anchor" aria-label="anchor" href="#arg-groups"></a></dt>
<dd><p>a grouping vector or factor for MOTUs.
<code>NA</code> values treated as a group level</p></dd>


<dt id="arg-fun">FUN<a class="anchor" aria-label="anchor" href="#arg-fun"></a></dt>
<dd><p>a function of MOTU aggregation.
Default is the sum of MOTUs read abundances for each grouping value.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>metabarlist</code> where the table `reads` contains MOTUs abundances aggregated according to a grouping vector/factor (e.g. taxonomic assignment at the phylum level), using a method defined in <code>FUN</code> and where number of columns of tables `reads` will be equal to that of the number of groups in `groups`.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function <code>aggregate_motus</code> is typically used for aggregating MOTUs at a given taxonomic resolution. The user is free to use its own method of aggregation, but the most common aggregation method is to sum reads for each taxa and is therefore pre-encoded in <code>FUN_agg_motus_sum</code>.</p>
<p>After aggregation, the information retained in the `motus` table corresponds to the
information of the most abundant MOTU in a given group.</p>
    </div>
    <div id="functions">
    <h2>Functions</h2>

<ul><li><p><code>aggregate_motus</code>: Aggregate MOTUs in a <code>metabarlist</code> object according to a grouping factor or vector for each pcr.</p></li>
<li><p><code>FUN_agg_motus_sum</code>: compute the sum of reads according to a grouping factor or vector for each pcr.</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="aggregate_pcrs.html">aggregate_pcrs</a></code>, <code><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></code>, <code><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Lucie Zinger</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">soil_euk</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## With MOTU phylum assignment as the grouping factor and</span></span></span>
<span class="r-in"><span><span class="co">## default grouping aggregation (sum reads across replicates)</span></span></span>
<span class="r-in"><span><span class="va">soil_euk_ag</span> <span class="op">&lt;-</span> <span class="fu">aggregate_motus</span><span class="op">(</span><span class="va">soil_euk</span>, groups <span class="op">=</span> <span class="va">soil_euk</span><span class="op">$</span><span class="va">motus</span><span class="op">$</span><span class="va">phylum_name</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some PCRs in out have a number of reads of zero in table `reads`!</span>
<span class="r-in"><span><span class="fu"><a href="summary_metabarlist.html">summary_metabarlist</a></span><span class="op">(</span><span class="va">soil_euk</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dataset_dimension</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         n_row n_col</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reads     384 12647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> motus   12647    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pcrs      384    11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> samples    64     8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dataset_statistics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         nb_reads nb_motus avg_reads sd_reads avg_motus sd_motus</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pcrs     3538913    12647  9215.919 10283.45  333.6849  295.440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> samples  2797294    12382 10926.930 10346.66  489.5117  239.685</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="summary_metabarlist.html">summary_metabarlist</a></span><span class="op">(</span><span class="va">soil_euk_ag</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dataset_dimension</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         n_row n_col</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> reads     384    29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> motus      29    15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pcrs      384    11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> samples    64     8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $dataset_statistics</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         nb_reads nb_motus avg_reads sd_reads avg_motus sd_motus</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pcrs     3538913       29  9215.919 10283.45  10.45052 5.629802</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> samples  2797294       27 10926.930 10346.66  14.11719 2.092456</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## With a custom function (here equivalent to FUN_agg_sum,</span></span></span>
<span class="r-in"><span><span class="co">## i.e. summing all MOTU abundances across groups)</span></span></span>
<span class="r-in"><span><span class="va">soil_euk_ag</span> <span class="op">&lt;-</span> <span class="fu">aggregate_motus</span><span class="op">(</span><span class="va">soil_euk</span>, groups <span class="op">=</span> <span class="va">soil_euk</span><span class="op">$</span><span class="va">motus</span><span class="op">$</span><span class="va">phylum_name</span>,</span></span>
<span class="r-in"><span>                               FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">metabarlist</span>, <span class="va">groups</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>                                       <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rowsum.html" class="external-link">rowsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">metabarlist</span><span class="op">$</span><span class="va">reads</span><span class="op">)</span>, <span class="va">groups</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Some PCRs in out have a number of reads of zero in table `reads`!</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Lucie Zinger, Frédéric Boyer, Clément Lionnet, Anne-Sophie Benoiston.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

