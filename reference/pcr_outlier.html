<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Identify non-conforming PCR replicates — pcr_outlier • metabaR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Identify non-conforming PCR replicates — pcr_outlier" />
<meta property="og:description" content="Identify the non-conforming sample or control PCR replicates in the PCRs table from a metabarlist object.
Process numerous reiterations to compare distance densities within PCR replicates and between PCR replicates." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metabaR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/metabaRF-vignette.html">Let's metabaR!</a>
    </li>
    <li>
      <a href="../articles/metabaRF-vignette_karst.html">The karst dataset: sampler effect and technical reproducibility</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/metabaRfactory/metabaR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Identify non-conforming PCR replicates</h1>
    <small class="dont-index">Source: <a href='https://github.com/metabaRfactory/metabaR/blob/master/R/pcr_outlier.R'><code>R/pcr_outlier.R</code></a></small>
    <div class="hidden name"><code>pcr_outlier.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Identify the non-conforming sample or control PCR replicates in the PCRs table from a <code>metabarlist</code> object.
Process numerous reiterations to compare distance densities within PCR replicates and between PCR replicates.</p>
    </div>

    <pre class="usage"><span class='fu'>pcr_outlier</span><span class='op'>(</span>
  <span class='va'>metabarlist</span>,
  FUN <span class='op'>=</span> <span class='va'>bray_function</span>,
  groups <span class='op'>=</span> <span class='va'>metabarlist</span><span class='op'>$</span><span class='va'>pcrs</span><span class='op'>$</span><span class='va'>sample_id</span>,
  graphics <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='fu'>filter_replicat</span><span class='op'>(</span><span class='va'>sub_matrix</span>, <span class='va'>threshold</span><span class='op'>)</span>

<span class='fu'>coa_function</span><span class='op'>(</span><span class='va'>reads</span><span class='op'>)</span>

<span class='fu'>bray_function</span><span class='op'>(</span><span class='va'>reads</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>metabarlist</th>
      <td><p>a <code>metabarlist</code> object</p></td>
    </tr>
    <tr>
      <th>FUN</th>
      <td><p>a function returning a distance matrix. The distance matrix should be a `dist` object which has the same dimensions as the number of rows in the `reads`table, i.e number of PCRs.</p></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>a vector containing the replicate identifier. The vector must have the same dimensions as the `PCRs` table from a <code>metabarlist</code> object. Default = metabarlist$pcrs$sample_id</p></td>
    </tr>
    <tr>
      <th>graphics</th>
      <td><p>a boolean value to plot the distance densities for each iteration. Default = FALSE</p></td>
    </tr>
    <tr>
      <th>sub_matrix</th>
      <td><p>a distance matrix for replicates comparisons</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>a threshold below which a pcr is considered as outlier</p></td>
    </tr>
    <tr>
      <th>reads</th>
      <td><p>a reads table from a <code>metabarlist</code> object</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a data frame with the replicate groups and a `replicating`column. If not possible, the function will terminate and return an error message.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function identifies non-conforming sample or control replicates.</p>
<p>The parameter `groups` defines groups of replicates. The vector should be arranged following the format of a `PCRs` table from the <code>metabarlist</code>.
Note: If the distance within replicates is higher than the distance between replicates, the function cannot return any result because all replicates are removed.
The parameter `FUN` defines the function used to compute the distance matrix. The function will return an object of class `dist` with the same length as the input table.
The default function use the `decostand` and `vegdist` functions from the `vegan` package to perform a correspondance analysis of the `reads` table from the <code>metabarlist</code>, and returns a distance matrix.
Default function detail:
bray_function &lt;- function(reads) 
  distance_matrix &lt;- vegdist(decostand(reads, method = 'total'), method='bray')
  return(distance_matrix)</p>
<p>When the `graphics` parameter is defined as True, a graphic is plotted with the density of distance within replicate and between replicate. The threshold is also plotted as a vertical line at the intersection of the two densities.</p>
<p>Note: In the circumstance where numerous sequencing projects have been pooled and analysed on the the same PCR plates, the function must be processed individually for each project, to avoid calculating distances which are meaningless.</p>
    <h2 class="hasAnchor" id="functions"><a class="anchor" href="#functions"></a>Functions</h2>

    
<ul>
<li><p><code>pcr_outlier</code>: Identifying the non-replicating samples or controls in the table PCRs from a <code>metabarlist</code> object.</p></li>
<li><p><code>filter_replicat</code>: recursive function to find the non replicating samples or controls</p></li>
<li><p><code>coa_function</code>: distance function with ade4 package and coa analysis</p></li>
<li><p><code>bray_function</code>: distance function with vegan package and Bray-Curtis distance</p></li>
</ul>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Frédéric Boyer &amp; Clément Lionnet</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>soil_euk</span><span class='op'>)</span>

<span class='va'>sample_subset</span> <span class='op'>&lt;-</span> <span class='fu'><a href='subset_metabarlist.html'>subset_metabarlist</a></span><span class='op'>(</span><span class='va'>soil_euk</span>, <span class='st'>"pcrs"</span>,
                                    <span class='va'>soil_euk</span><span class='op'>$</span><span class='va'>pcrs</span><span class='op'>$</span><span class='va'>type</span> <span class='op'>==</span> <span class='st'>"sample"</span><span class='op'>)</span>
<span class='fu'>filter_replicat</span><span class='op'>(</span><span class='va'>sample_subset</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Lucie Zinger, Frédéric Boyer, Clément Lionnet, Anne-Sophie Benoiston.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


